### 数字谐振器的设计

电路中的谐振：当电路中的激励的频率等于电路的固有频率时，电路电磁振荡的振幅也将达到峰值。

输出频谱中只突显谐振频率，这样的滤波器叫做数字谐振器。

### DTFT

采样间隔T减小，采样频率增大，频谱观察范围扩大。

频域周期对应时域离散

时域周期对应频谱离散





这段代码生成的随机数同样服从 **标准正态分布** N(0, 1)，但使用的是 **Box-Muller 变换方法**。

### 原理分析：

1. **Box-Muller 变换**：
   - 输入：两个独立的均匀分布 U(0,1) 随机变量 U1 和 U2
   - 变换公式：
     \[
     Z_0 = \sqrt{-2\ln(U_1)} \cos(2\pi U_2)
     \]
     \[
     Z_1 = \sqrt{-2\ln(U_1)} \sin(2\pi U_2)
     \]
   - 输出：两个独立的标准正态分布 N(0,1) 随机变量 Z₀ 和 Z₁

2. **代码解析**：
   - `U1=rand(L,1);` 和 `U2=rand(L,1);`：生成两个独立的均匀分布 U(0,1) 序列
   - `Z=sqrt(-2*log(U1)).*cos(2*pi*U2);`：应用 Box-Muller 变换（只使用了 cos 部分，生成 L 个样本）
   - `R3=Z*sigma+mu;`：线性变换，这里 σ=1，μ=0，所以 R3 = Z ~ N(0,1)

3. **为什么是正态分布**：
   - 数学上可以证明，这个变换恰好将两个均匀分布转换为两个独立的标准正态分布
   - 省略了 sin 部分，所以只利用了变换的一半潜力（如果同时计算 cos 和 sin，可以用 2L 个均匀随机数生成 2L 个正态随机数）

### 分布特性：
- **均值和方差**：生成的 Z 服从 N(0,1)，经过 R3=Z*1+0 后仍为 N(0,1)
- **独立性**：如果 U1 和 U2 是独立的，那么生成的 Z 值之间也是独立的

### 数值验证：
```matlab
% 验证代码
mu=0; sigma=1;
L=100000;
U1=rand(L,1);
U2=rand(L,1);
Z=sqrt(-2*log(U1)).*cos(2*pi*U2);
R3=Z*sigma+mu;

disp(['均值: ', num2str(mean(R3))])      % 接近 0
disp(['标准差: ', num2str(std(R3))])     % 接近 1
disp(['偏度: ', num2str(skewness(R3))])  % 接近 0（对称性）
disp(['峰度: ', num2str(kurtosis(R3))])  % 接近 3（正态分布峰度）
```

### 与前两种方法的比较：

| 方法         | 原理                            | 特点                                 |
| ------------ | ------------------------------- | ------------------------------------ |
| method 1     | 直接调用 `random('Normal',...)` | 最直观，但可能较慢                   |
| method 2     | `randn()` + 线性变换            | 最常用，效率高                       |
| **method 3** | **Box-Muller 变换**             | **数学原理清晰，可避免调用专用函数** |

### 应用场景：
Box-Muller 变换在以下情况特别有用：
1. 需要理解正态随机数生成原理的教学场景
2. 在没有内置正态随机数生成器的环境中（如某些嵌入式系统）
3. 需要从特定均匀随机数生成器产生正态随机数时

**结论**：这段代码通过 Box-Muller 变换，将均匀分布转换为标准正态分布，最终生成 N(0,1) 的随机数。与前两种方法相比，它是从基本原理出发的实现方式。





`X = (U < p);` 是 **MATLAB中的逻辑索引和数组比较语法**。让我详细解释：

## 语法解析：

### 1. **元素级比较**：

matlab

```
U < p
```



- `U` 是一个数组（这里是1×L的行向量）
- `p` 是一个标量（或相同尺寸的数组）
- `<` 是**关系运算符**，对每个元素进行"小于"比较

### 2. **返回逻辑数组**：

比较的结果是一个**逻辑数组**（logical array）：

- 大小与 `U` 相同（1×L）
- 每个元素是 `true` (1) 或 `false` (0)
- 对应位置：如果 U(i) < p，则结果为 true(1)；否则为 false(0)

### 3. **赋值给变量**：

matlab

```
X = (U < p);
```



- 将逻辑数组赋值给变量 `X`
- `X` 现在是逻辑数据类型（logical）

## 示例演示：

matlab

```
% 示例1：标量比较
U = [0.2, 0.5, 0.8, 0.1];
p = 0.3;

result = U < p;
% result = [true, false, false, true]
% 对应：0.2<0.3=true, 0.5<0.3=false, 0.8<0.3=false, 0.1<0.3=true

% 在MATLAB中显示
disp('U:');
disp(U);
disp('U < 0.3:');
disp(result);
disp('作为数值显示:');
disp(double(result));  % 转换为数值：true=1, false=0
```



输出：

text

```matlab
U:
    0.2000    0.5000    0.8000    0.1000

U < 0.3:
  1  0  0  1

作为数值显示:
     1     0     0     1
```



## 括号的作用：

matlab

```matlab
% 有无括号效果相同
X1 = U < p;     % 无括号
X2 = (U < p);   % 有括号

% 括号只是提高可读性，确保操作顺序
% 在没有歧义的情况下，MATLAB会正确解析
```



在信道建模中，中心卡方分布与瑞利衰落相关，非中心卡方分布与莱斯衰落相关。

非中心卡方分布与莱斯分布相关，而中心卡方分布与瑞利分布相关。

![image-20251231200111682](C:\Users\22364\AppData\Roaming\Typora\typora-user-images\image-20251231200111682.png)

若对卡方随机变量取平方根，则得到卡方分布随机变量。自由度为 2 的卡方分布随机变量实际上服从瑞利分布。



瑞利随机变量在建模多径衰落时非常有用。
在多径环境中存在大量散射分量，这为对到达接收机前端的多径信号的实部和虚部应用中心极限定理提供了条件。
若散射路径数量足够大，则同相与正交分量可近似为高斯随机变量。
因此，信号的包络呈现为复高斯随机变量的形式——也称为瑞利随机变量。



瑞利分布非常适用于建模发射机与接收机之间不存在主导视距路径的多径信道。
若存在视距路径，则包络分布不再是瑞利分布，而是莱斯分布。
在此情况下，随机多径分量将与最强的视距分量叠加。



Nakagami 分布（或称 Nakagami-m 分布）与伽玛函数相关。
Nakagami 分布由两个参数表征：形状参数 m 和展宽参数 ω。

![image-20251231202350877](C:\Users\22364\AppData\Roaming\Typora\typora-user-images\image-20251231202350877.png)

Nakagami 分布可用于建模呈现多径衰落的无线链路。
当形状参数 m 设为 1 时，Nakagami 衰落退化为瑞利衰落；
当 m = 0.5 时，它等效于单边高斯分布。

Nakagami 衰落模型最初被提出是因为其与短波电离层传播的实测结果吻合。
该模型也描述了经过最大比合并后接收信号的幅度特性，并常用于建模来自多个干扰源的叠加干扰，因为多个独立同分布瑞利随机变量的和具有 Nakagami 分布的幅度特性。
Nakagami 与莱斯衰落在均值附近的行为相似。

Nakagami 分布随机变量可通过伽玛函数或卡方分布随机变量生成。



中心极限定理指出：独立同分布随机变量（具有有限均值与方差）的和随着样本量 N → ∞ 趋近于正态分布。  

简言之，该定理表明在一定普遍条件下，服从相同底层分布的独立观测值之和近似服从正态分布，且该近似程度随观测数量的增加而逐步提升。  

独立观测的底层分布可以是任意类型，如二项分布、泊松分布、指数分布、卡方分布等。

Cholesky 分解是对给定矩阵进行开方运算的矩阵等价操作。
正如任意标量值仅当其为正数时才存在实数平方根（否则为虚根），若要将矩阵分解为平方根等价形式，该矩阵必须是正定矩阵。



提到高斯随机序列（如高斯噪声），我们通常认为其功率谱密度是平坦的。
但需理解，高斯序列的功率谱密度未必平坦。
这引出了白噪声与有色噪声序列的区别，如图2.22所示。

![image-20251231210358276](C:\Users\22364\AppData\Roaming\Typora\typora-user-images\image-20251231210358276.png)

白噪声序列定义为功率谱密度在所有频率上恒定的任意随机序列。
高斯白噪声是一种高斯随机序列，其幅度服从高斯分布且功率谱密度为常数。
从另一角度看，频域中的恒定功率谱密度意味着时域中的平均自相关函数为冲激函数（狄拉克δ函数），即任意时刻的噪声幅度仅与自身相关。
因此，这类序列也称为不相关随机序列。高斯白噪声过程完全由其均值与方差表征。

有色噪声序列则是非白噪声随机序列，其功率谱密度随频率变化。
对于有色噪声，任意时刻的噪声幅度与其他时刻的噪声幅度相关，因此有色噪声序列的自相关函数不是冲激函数。
这类序列也称为相关随机序列。有色高斯噪声过程完全由其均值及功率谱密度形状（或自相关函数形状）表征。

通过滤波或线性变换，可将不相关高斯序列转换为相关序列，这一过程保持幅度的高斯分布特性，仅改变相关性（等效于改变功率谱密度）。



假设我们观测到一个真实世界的信号 y[n]，其具有任意频谱 y(f)。
我们希望用极少参数描述 y[n] 的长序列，如在线性预测编码等应用中。
这里描述的建模方法试图回答以下两个问题：

1. 是否仅通过传递函数对白噪声频谱进行整形，就能模拟信号的一阶统计量（均值/方差）和二阶统计量（相关性、频谱）？（见图2.22）
2. 对于白噪声输入，该方法是否会产生相同的统计特性（频谱、相关性、均值和方差）？

若以上两个问题的答案为“是”，我们只需设定系统的建模参数，并用白噪声激励该系统，即可生成所需的真实世界信号。
这可以减少通信系统应用中需要传输的数据量。
该方法可用于将不相关的白高斯噪声序列转换为具有期望频谱特性的有色高斯噪声序列。

两种为给定均值和功率谱密度形状生成有色高斯噪声的方法：谱分解法与自回归模型法。



幂律关系 \(1/f^\alpha\) 在功率谱中刻画了许多自然系统中观测量的涨落特性。  
许多自然系统表现出某种 \(1/f^\alpha\) 噪声，这是一种随机过程，其功率谱密度的幂指数取值范围为 \(-2 \leq \alpha \leq 2\)。  
简言之，\(1/f^\alpha\) 噪声是一种有色噪声，其在整个频率范围内的功率谱密度具有 \(1/f^\alpha\) 形式。

根据 α 的取值，\(1/f^\alpha\) 噪声可分为不同类型：  
- **紫噪声**：α = -2，功率谱密度与 \(f^2\) 成正比。  
- **蓝噪声**：α = -1，功率谱密度与 \(f\) 成正比。  
- **白噪声**：α = 0，功率谱密度在整个频谱上平坦。  
- **粉红噪声**：α = 1，功率谱密度与 \(1/f\) 成正比，即频率每增加一倍频程下降 3 dB。  
- **布朗噪声**：α = 2，功率谱密度与 \(1/f^2\) 成正比，因此频率每增加一倍频程下降 6 dB。  

幂律噪声可通过将零均值白噪声通过一个 N 阶自回归滤波器生成：















通信系统设计的主要目标是满足以下一个或多个要求：  

- **频带效率**：使传输信号在分配频谱中占用最小带宽，以频带效率（频谱效率）η_B 衡量。  
- **功率效率**：系统应能以最低实际功率可靠发送信息，以功率效率 η_P 衡量。  
- **数据传输速率**：支持更高的传输速率（比特/秒）。  
- **抗多径与衰落**：对多径效应和衰落具有鲁棒性。  
- **抗同频干扰**：抑制同频其他信号源的干扰（低载波同频干扰比 CCI）。  
- **邻道干扰抑制**：降低邻道干扰（以邻道功率比 ACPR 衡量）。  
- **易于实现与低成本**：实现简便且运营成本低。  

本章旨在描述在设计给定信道的通信系统时，前三个目标的影响。  
关于这三个因素的详细信息可从香农有噪信道编码定理中获得。



若试图以高于容量的速率传输数据，则无法从错误中恢复信息。这称为**香农有噪信道编码定理**，可概括如下：

- 给定通信系统存在最大信息速率 C*C*，称为信道容量。
- 若传输信息速率 R<C*R*<*C*，则通过智能编码技术可在噪声环境下实现任意小的误码概率。
- 为获得更低误码率，编码器需处理更长的信号数据块，这会导致更长时延和更高计算需求。

该定理表明，采用足够先进的编码技术，可以以任意小的误差逼近最大信道容量。
直观上可理解：对于给定通信系统，随着信息速率增加，每秒错误数也会增加。



"无约束容量"特指**只有平均功率约束，没有峰值功率约束**的情况。



### 2. **调制阶数 M\*M\* 影响频谱效率**

- 高阶调制（如 64-QAM、256-QAM）：每个符号携带更多比特（log⁡2Mlog2*M* 比特/符号），因此**频谱效率更高**（bit/s/Hz）。
- 低阶调制（如 BPSK，M=2*M*=2）：每个符号只传 1 比特，频谱效率低，但抗噪能力强。

例如：

- BPSK（M=2*M*=2）：最大频谱效率 ≈ 1 bit/s/Hz
- 16-QAM（M=16*M*=16）：≈ 4 bit/s/Hz
- 1024-QAM（M=1024*M*=1024）：≈ 10 bit/s/Hz

### 3. **调制阶数与香农极限的关系：通过频谱效率“连接”**

香农极限是一条 **“Eb/N0\*E\**b\*/\*N\*0 vs. 频谱效率 η\*η\*”** 的曲线：

- **低频谱效率区域**（η→0*η*→0）：接近 -1.59 dB 的功率效率极限。
- **高频谱效率区域**（η*η* 很大）：需要很高的 Eb/N0*E**b*/*N*0 才能可靠通信。

而**高阶调制（大 M\*M\*）对应高频谱效率**，因此：

- 使用高阶调制时，系统工作在香农曲线的**高频谱效率端**，需要更高的 Eb/N0*E**b*/*N*0。
- 使用低阶调制时，系统工作在**低频谱效率端**，可以接近 -1.59 dB。

> ✅ 所以：**调制阶数 M\*M\* 并不改变香农极限本身，但它决定了系统在香农容量曲线上的工作点。**



**将调制信号限制为有限集**，等价于将星座图中的信号点数量约束为有限个，其对应的容量称为**星座约束容量**。

由于信道冲激响应 h*h* 是随机变量，公式 3.44 中的信道容量也是随机的。
为解决此问题，定义了**遍历信道容量**与**中断容量**。
遍历信道容量定义为互信息的统计平均，其期望对 ∣h∣2∣*h*∣2 求取：



线性分组码



**Eb 与香农公式的核心关系**体现在 **香农极限** 的推导中，它定义了在任意小误码率下可达到的**最低 Eb/N0**。

---

### 1. **香农信道容量公式**（AWGN 信道）
\[
C = B \log_2 \left( 1 + \frac{P}{N_0 B} \right)
\]
其中：
- \(C\)：信道容量（比特/秒）
- \(B\)：带宽（赫兹）
- \(P\)：信号平均功率（瓦）
- \(N_0\)：噪声功率谱密度（瓦/赫兹）

---

### 2. **引入 Eb 的变换**
由定义：
\[
P = E_b \cdot R_b
\]
- \(R_b\)：实际传输比特率（比特/秒）
- 当系统以极限速率传输时，\(R_b = C\)（达到容量极限），则：
\[
P = E_b \cdot C
\]
代入香农公式：
\[
C = B \log_2 \left( 1 + \frac{E_b \cdot C}{N_0 B} \right)
\]
令 \(\eta = \frac{C}{B}\)（**频谱效率**，单位：比特/秒/赫兹），得：
\[
\eta = \log_2 \left( 1 + \eta \cdot \frac{E_b}{N_0} \right)
\]
即：
\[
\frac{E_b}{N_0} = \frac{2^\eta - 1}{\eta}
\]
此式建立了 **Eb/N0 与频谱效率 η 的严格关系**。

---

### 3. **香农极限**
- 当 \(\eta \to 0\)（无限带宽）时，对 \(\frac{2^\eta - 1}{\eta}\) 取极限（洛必达法则）：
\[
\lim_{\eta \to 0} \frac{2^\eta - 1}{\eta} = \ln 2 \quad (\approx 0.693)
\]
即：
\[
\left( \frac{E_b}{N_0} \right)_{\text{min}} = \ln 2 \quad \text{（线性值）}
\]
转换为分贝：
\[
10 \log_{10}(\ln 2) \approx -1.59 \ \text{dB}
\]
这就是**绝对香农极限**：任何编码调制方案在任意小误码率下所需的 Eb/N0 不得低于 **-1.59 dB**。

---

### 4. **物理意义**
| 参数           | 含义                            | 与 Eb 的关系                               |
| -------------- | ------------------------------- | ------------------------------------------ |
| **频谱效率 η** | 每赫兹带宽传输的比特率          | η 越高，所需 Eb/N0 越大                    |
| **Eb/N0**      | 每比特能量相对于噪声的强度      | 香农公式给出 η 与 Eb/N0 的**理论最优折衷** |
| **香农极限**   | 可靠通信的**最低 Eb/N0**（η→0） | -1.59 dB                                   |

---

### 5. **应用**
- 评估编码/调制方案的**功率效率**：比较其 Eb/N0





**码长越长，越接近香农容量极限**。



例如，在 \( \text{GF}(2) \) 中，码字 \( (0,0,0,1) \) 与 \( (1,0,1,0) \) 之间的汉明距离为 3，因为它们在三个位置上取值不同。对于**独立同分布**（i.i.d.）且错误幅值服从**离散均匀分布**的信道模型，汉明距离是最为合适的距离度量。

分组码 \( \mathcal{C} \) 的**最小距离**（minimum distance）是指该码中任意两个不同码字之间汉明距离的最小值，记为 \( d_{\min} \)。该参数直接决定了该码的**检错能力**和**纠错能力**。较大的 \( d_{\min} \) 意味着码对随机错误具有更强的鲁棒性。

分组码的最小汉明距离 \( d_{\min} \) 与其差错控制能力之间的基本关系如下：

- **检错能力**：若分组码的最小汉明距离为 \( d_{\min} \)，则该码**可保证检测最多 \( e = d_{\min} - 1 \) 个错误**。  
  换言之，设 \( \mathbf{c}_1 \) 与 \( \mathbf{c}_2 \) 是码 \( \mathcal{C} \) 中汉明距离最近的两个码字（即 \( d_H(\mathbf{c}_1, \mathbf{c}_2) = d_{\min} \)）。若发送的是 \( \mathbf{c}_1 \)，而接收端恰好收到 \( \mathbf{c}_2 \)，则该错误将**无法被检测**。

- **纠错能力**：若分组码的最小汉明距离为 \( d_{\min} \)，且接收端采用**最近邻译码**（nearest-neighbor decoding，即最大似然译码在离散无记忆信道下的实现），则该码**可保证纠正最多 \( t = \left\lfloor \dfrac{d_{\min} - 1}{2} \right\rfloor \) 个错误**。

因此，最小距离 \( d_{\min} \) 是评估分组码性能的核心参数，直接刻画了其在给定信道条件下实现可靠通信的潜力。



### 2. **信噪比换算**

```matlab
EcN0dB = EbN0dB + 10*log10(log2(M)) + 10*log10(k/n);
```

**重要换算**：

- `Eb/N0`：每信息比特能量与噪声谱密度比
- `Ec/N0`：每编码符号能量与噪声谱密度比
- 换算公式：`Ec/N0 = Eb/N0 + 10log10(k/n) + 10log10(log2M)`
  - 第一项：码率损失补偿（4/7 ≈ -2.43dB）
  - 第二项：调制阶数补偿（BPSK为0dB）

在该代码中，进行如下换算：

```matlab
EcN0dB = EbN0dB + 10*log10(log2(M)) + 10*log10(k/n);
```

其目的是**将每信息比特能量信噪比 \( E_b/N_0 \)（dB）转换为每编码符号能量信噪比 \( E_c/N_0 \)（dB）**，以便在添加 AWGN 噪声时使用正确的噪声功率。原因如下：

---

### 1. **定义区分**：
- \( E_b \)：**每信息比特**的能量；
- \( E_c \)：**每编码后符号**（即信道符号）的能量。

由于引入了信道编码和调制，两者关系为：
\[
E_c = E_b \cdot R_c \cdot R_m
\]
其中：
- \( R_c = k/n \)：**编码码率**（信息比特数 / 编码后比特数）；
- \( R_m = \log_2(M) \)：**调制频谱效率**（每符号承载的比特数，BPSK 时 \( M=2 \)，故 \( \log_2(2)=1 \)）。

> 注：此处的“符号”指调制符号（BPSK 中一个符号对应一个编码比特）。

---

### 2. **能量关系推导**（BPSK 场景）：
- 对于 BPSK，**每个编码比特映射为一个调制符号**，因此调制不改变符号速率。
- 但编码引入了冗余：传输 \( k \) 个信息比特需发送 \( n \) 个编码比特。
- 若总发射功率不变，则**每个编码比特的能量 \( E_c \)** 与信息比特能量 \( E_b \) 的关系为：
  \[
  E_c = E_b \cdot \frac{k}{n}
  \]
  （因为相同总能量被分配到更多比特上，每个编码比特能量降低）。

- 调制阶数影响：若为 M-PSK/QAM，则每个符号携带 \( \log_2(M) \) 比特，但**BPSK 时 \( \log_2(M)=1 \)**，此项为 0。

因此，在 BPSK 下，公式简化为：
\[
E_c/N_0 = E_b/N_0 + 10\log_{10}(k/n)
\]

---

### 3. **代码中的通用写法**：
尽管当前是 BPSK（\( \log_2(M)=1 \)，第二项为 0），但代码保留了 `10*log10(log2(M))` 以**兼容更高阶调制**（如 QPSK、16-QAM）。完整关系为：
\[
\frac{E_c}{N_0} = \frac{E_b}{N_0} \cdot \underbrace{\log_2(M)}_{\text{调制增益}} \cdot \underbrace{\frac{k}{n}}_{\text{编码码率}}
\]
取对数（dB）得：
\[
E_c/N_0 \text{ (dB)} = E_b/N_0 \text{ (dB)} + 10\log_{10}(\log_2(M)) + 10\log_{10}(k/n)
\]

---

### 4. **为什么需要换算**？
- AWGN 信道的噪声功率需根据**实际发送符号的能量 \( E_c \)** 计算。
- 若直接用 \( E_b/N_0 \) 添加噪声，会导致信噪比设置错误（高估性能）。
- **正确做法**：根据编码和调制参数，将目标 \( E_b/N_0 \) 转换为 \( E_c/N_0 \)，再据此生成噪声。

---

### ✅ 总结：
该换算确保了：
1. **公平比较**：编码系统的 \( E_b/N_0 \) 与未编码系统一致（均指每信息比特能量）；
2. **正确仿真**：AWGN 噪声功率基于实际发送符号的能量 \( E_c \) 计算。



