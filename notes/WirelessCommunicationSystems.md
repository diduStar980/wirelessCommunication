### 数字谐振器的设计

电路中的谐振：当电路中的激励的频率等于电路的固有频率时，电路电磁振荡的振幅也将达到峰值。

输出频谱中只突显谐振频率，这样的滤波器叫做数字谐振器。

### DTFT

采样间隔T减小，采样频率增大，频谱观察范围扩大。

频域周期对应时域离散

时域周期对应频谱离散





这段代码生成的随机数同样服从 **标准正态分布** N(0, 1)，但使用的是 **Box-Muller 变换方法**。

### 原理分析：

1. **Box-Muller 变换**：
   - 输入：两个独立的均匀分布 U(0,1) 随机变量 U1 和 U2
   - 变换公式：
     \[
     Z_0 = \sqrt{-2\ln(U_1)} \cos(2\pi U_2)
     \]
     \[
     Z_1 = \sqrt{-2\ln(U_1)} \sin(2\pi U_2)
     \]
   - 输出：两个独立的标准正态分布 N(0,1) 随机变量 Z₀ 和 Z₁

2. **代码解析**：
   - `U1=rand(L,1);` 和 `U2=rand(L,1);`：生成两个独立的均匀分布 U(0,1) 序列
   - `Z=sqrt(-2*log(U1)).*cos(2*pi*U2);`：应用 Box-Muller 变换（只使用了 cos 部分，生成 L 个样本）
   - `R3=Z*sigma+mu;`：线性变换，这里 σ=1，μ=0，所以 R3 = Z ~ N(0,1)

3. **为什么是正态分布**：
   - 数学上可以证明，这个变换恰好将两个均匀分布转换为两个独立的标准正态分布
   - 省略了 sin 部分，所以只利用了变换的一半潜力（如果同时计算 cos 和 sin，可以用 2L 个均匀随机数生成 2L 个正态随机数）

### 分布特性：
- **均值和方差**：生成的 Z 服从 N(0,1)，经过 R3=Z*1+0 后仍为 N(0,1)
- **独立性**：如果 U1 和 U2 是独立的，那么生成的 Z 值之间也是独立的

### 数值验证：
```matlab
% 验证代码
mu=0; sigma=1;
L=100000;
U1=rand(L,1);
U2=rand(L,1);
Z=sqrt(-2*log(U1)).*cos(2*pi*U2);
R3=Z*sigma+mu;

disp(['均值: ', num2str(mean(R3))])      % 接近 0
disp(['标准差: ', num2str(std(R3))])     % 接近 1
disp(['偏度: ', num2str(skewness(R3))])  % 接近 0（对称性）
disp(['峰度: ', num2str(kurtosis(R3))])  % 接近 3（正态分布峰度）
```

### 与前两种方法的比较：

| 方法         | 原理                            | 特点                                 |
| ------------ | ------------------------------- | ------------------------------------ |
| method 1     | 直接调用 `random('Normal',...)` | 最直观，但可能较慢                   |
| method 2     | `randn()` + 线性变换            | 最常用，效率高                       |
| **method 3** | **Box-Muller 变换**             | **数学原理清晰，可避免调用专用函数** |

### 应用场景：
Box-Muller 变换在以下情况特别有用：
1. 需要理解正态随机数生成原理的教学场景
2. 在没有内置正态随机数生成器的环境中（如某些嵌入式系统）
3. 需要从特定均匀随机数生成器产生正态随机数时

**结论**：这段代码通过 Box-Muller 变换，将均匀分布转换为标准正态分布，最终生成 N(0,1) 的随机数。与前两种方法相比，它是从基本原理出发的实现方式。





`X = (U < p);` 是 **MATLAB中的逻辑索引和数组比较语法**。让我详细解释：

## 语法解析：

### 1. **元素级比较**：

matlab

```
U < p
```



- `U` 是一个数组（这里是1×L的行向量）
- `p` 是一个标量（或相同尺寸的数组）
- `<` 是**关系运算符**，对每个元素进行"小于"比较

### 2. **返回逻辑数组**：

比较的结果是一个**逻辑数组**（logical array）：

- 大小与 `U` 相同（1×L）
- 每个元素是 `true` (1) 或 `false` (0)
- 对应位置：如果 U(i) < p，则结果为 true(1)；否则为 false(0)

### 3. **赋值给变量**：

matlab

```
X = (U < p);
```



- 将逻辑数组赋值给变量 `X`
- `X` 现在是逻辑数据类型（logical）

## 示例演示：

matlab

```
% 示例1：标量比较
U = [0.2, 0.5, 0.8, 0.1];
p = 0.3;

result = U < p;
% result = [true, false, false, true]
% 对应：0.2<0.3=true, 0.5<0.3=false, 0.8<0.3=false, 0.1<0.3=true

% 在MATLAB中显示
disp('U:');
disp(U);
disp('U < 0.3:');
disp(result);
disp('作为数值显示:');
disp(double(result));  % 转换为数值：true=1, false=0
```



输出：

text

```matlab
U:
    0.2000    0.5000    0.8000    0.1000

U < 0.3:
  1  0  0  1

作为数值显示:
     1     0     0     1
```



## 括号的作用：

matlab

```matlab
% 有无括号效果相同
X1 = U < p;     % 无括号
X2 = (U < p);   % 有括号

% 括号只是提高可读性，确保操作顺序
% 在没有歧义的情况下，MATLAB会正确解析
```



在信道建模中，中心卡方分布与瑞利衰落相关，非中心卡方分布与莱斯衰落相关。

非中心卡方分布与莱斯分布相关，而中心卡方分布与瑞利分布相关。

![image-20251231200111682](C:\Users\22364\AppData\Roaming\Typora\typora-user-images\image-20251231200111682.png)

若对卡方随机变量取平方根，则得到卡方分布随机变量。自由度为 2 的卡方分布随机变量实际上服从瑞利分布。



瑞利随机变量在建模多径衰落时非常有用。
在多径环境中存在大量散射分量，这为对到达接收机前端的多径信号的实部和虚部应用中心极限定理提供了条件。
若散射路径数量足够大，则同相与正交分量可近似为高斯随机变量。
因此，信号的包络呈现为复高斯随机变量的形式——也称为瑞利随机变量。



瑞利分布非常适用于建模发射机与接收机之间不存在主导视距路径的多径信道。
若存在视距路径，则包络分布不再是瑞利分布，而是莱斯分布。
在此情况下，随机多径分量将与最强的视距分量叠加。



Nakagami 分布（或称 Nakagami-m 分布）与伽玛函数相关。
Nakagami 分布由两个参数表征：形状参数 m 和展宽参数 ω。

![image-20251231202350877](C:\Users\22364\AppData\Roaming\Typora\typora-user-images\image-20251231202350877.png)

Nakagami 分布可用于建模呈现多径衰落的无线链路。
当形状参数 m 设为 1 时，Nakagami 衰落退化为瑞利衰落；
当 m = 0.5 时，它等效于单边高斯分布。

Nakagami 衰落模型最初被提出是因为其与短波电离层传播的实测结果吻合。
该模型也描述了经过最大比合并后接收信号的幅度特性，并常用于建模来自多个干扰源的叠加干扰，因为多个独立同分布瑞利随机变量的和具有 Nakagami 分布的幅度特性。
Nakagami 与莱斯衰落在均值附近的行为相似。

Nakagami 分布随机变量可通过伽玛函数或卡方分布随机变量生成。



中心极限定理指出：独立同分布随机变量（具有有限均值与方差）的和随着样本量 N → ∞ 趋近于正态分布。  

简言之，该定理表明在一定普遍条件下，服从相同底层分布的独立观测值之和近似服从正态分布，且该近似程度随观测数量的增加而逐步提升。  

独立观测的底层分布可以是任意类型，如二项分布、泊松分布、指数分布、卡方分布等。

Cholesky 分解是对给定矩阵进行开方运算的矩阵等价操作。
正如任意标量值仅当其为正数时才存在实数平方根（否则为虚根），若要将矩阵分解为平方根等价形式，该矩阵必须是正定矩阵。



提到高斯随机序列（如高斯噪声），我们通常认为其功率谱密度是平坦的。
但需理解，高斯序列的功率谱密度未必平坦。
这引出了白噪声与有色噪声序列的区别，如图2.22所示。

![image-20251231210358276](C:\Users\22364\AppData\Roaming\Typora\typora-user-images\image-20251231210358276.png)

白噪声序列定义为功率谱密度在所有频率上恒定的任意随机序列。
高斯白噪声是一种高斯随机序列，其幅度服从高斯分布且功率谱密度为常数。
从另一角度看，频域中的恒定功率谱密度意味着时域中的平均自相关函数为冲激函数（狄拉克δ函数），即任意时刻的噪声幅度仅与自身相关。
因此，这类序列也称为不相关随机序列。高斯白噪声过程完全由其均值与方差表征。

有色噪声序列则是非白噪声随机序列，其功率谱密度随频率变化。
对于有色噪声，任意时刻的噪声幅度与其他时刻的噪声幅度相关，因此有色噪声序列的自相关函数不是冲激函数。
这类序列也称为相关随机序列。有色高斯噪声过程完全由其均值及功率谱密度形状（或自相关函数形状）表征。

通过滤波或线性变换，可将不相关高斯序列转换为相关序列，这一过程保持幅度的高斯分布特性，仅改变相关性（等效于改变功率谱密度）。



假设我们观测到一个真实世界的信号 y[n]，其具有任意频谱 y(f)。
我们希望用极少参数描述 y[n] 的长序列，如在线性预测编码等应用中。
这里描述的建模方法试图回答以下两个问题：

1. 是否仅通过传递函数对白噪声频谱进行整形，就能模拟信号的一阶统计量（均值/方差）和二阶统计量（相关性、频谱）？（见图2.22）
2. 对于白噪声输入，该方法是否会产生相同的统计特性（频谱、相关性、均值和方差）？

若以上两个问题的答案为“是”，我们只需设定系统的建模参数，并用白噪声激励该系统，即可生成所需的真实世界信号。
这可以减少通信系统应用中需要传输的数据量。
该方法可用于将不相关的白高斯噪声序列转换为具有期望频谱特性的有色高斯噪声序列。

两种为给定均值和功率谱密度形状生成有色高斯噪声的方法：谱分解法与自回归模型法。
